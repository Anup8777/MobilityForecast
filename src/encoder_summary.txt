Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_13 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_14 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_33 (ConvLSTM2D)    (None, 6, 265, 265,  2624        ['input_13[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_37 (ConvLSTM2D)    (None, 6, 265, 265,  2624        ['input_14[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_34 (ConvLSTM2D)    (None, 6, 265, 265,  13888       ['conv_lstm2d_33[0][0]']         
                                 16)                                                              
                                                                                                  
 conv_lstm2d_38 (ConvLSTM2D)    (None, 6, 265, 265,  13888       ['conv_lstm2d_37[0][0]']         
                                 16)                                                              
                                                                                                  
 conv_lstm2d_35 (ConvLSTM2D)    (None, 6, 265, 265,  55424       ['conv_lstm2d_34[0][0]']         
                                 32)                                                              
                                                                                                  
 conv_lstm2d_39 (ConvLSTM2D)    (None, 6, 265, 265,  55424       ['conv_lstm2d_38[0][0]']         
                                 32)                                                              
                                                                                                  
 conv3d_8 (Conv3D)              (None, 6, 265, 265,  33          ['conv_lstm2d_35[0][0]']         
                                 1)                                                               
                                                                                                  
 conv3d_9 (Conv3D)              (None, 6, 265, 265,  33          ['conv_lstm2d_39[0][0]']         
                                 1)                                                               
                                                                                                  
 leaky_re_lu_18 (LeakyReLU)     (None, 6, 265, 265,  0           ['conv3d_8[0][0]']               
                                 1)                                                               
                                                                                                  
 leaky_re_lu_20 (LeakyReLU)     (None, 6, 265, 265,  0           ['conv3d_9[0][0]']               
                                 1)                                                               
                                                                                                  
 max_pooling3d_8 (MaxPooling3D)  (None, 3, 132, 132,  0          ['leaky_re_lu_18[0][0]']         
                                 1)                                                               
                                                                                                  
 max_pooling3d_9 (MaxPooling3D)  (None, 3, 132, 132,  0          ['leaky_re_lu_20[0][0]']         
                                 1)                                                               
                                                                                                  
 conv2d_33 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_32 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_37 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_36 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.linalg.matmul_16 (TFOpLambd  (None, 3, 132, 132,  0          ['conv2d_33[0][0]',              
 a)                              132)                             'conv2d_32[0][0]']              
                                                                                                  
 tf.linalg.matmul_18 (TFOpLambd  (None, 3, 132, 132,  0          ['conv2d_37[0][0]',              
 a)                              132)                             'conv2d_36[0][0]']              
                                                                                                  
 tf.nn.softmax_8 (TFOpLambda)   (None, 3, 132, 132,  0           ['tf.linalg.matmul_16[0][0]']    
                                 132)                                                             
                                                                                                  
 conv2d_34 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.nn.softmax_9 (TFOpLambda)   (None, 3, 132, 132,  0           ['tf.linalg.matmul_18[0][0]']    
                                 132)                                                             
                                                                                                  
 conv2d_38 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.linalg.matmul_17 (TFOpLambd  (None, 3, 132, 132,  0          ['tf.nn.softmax_8[0][0]',        
 a)                              1)                               'conv2d_34[0][0]']              
                                                                                                  
 tf.linalg.matmul_19 (TFOpLambd  (None, 3, 132, 132,  0          ['tf.nn.softmax_9[0][0]',        
 a)                              1)                               'conv2d_38[0][0]']              
                                                                                                  
 conv2d_35 (Conv2D)             (None, 3, 132, 132,  530         ['tf.linalg.matmul_17[0][0]']    
                                 265)                                                             
                                                                                                  
 conv2d_39 (Conv2D)             (None, 3, 132, 132,  530         ['tf.linalg.matmul_19[0][0]']    
                                 265)                                                             
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 3, 132, 132,  0          ['conv2d_35[0][0]']              
 )                               265)                                                             
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 3, 132, 132,  0          ['conv2d_39[0][0]']              
 )                               265)                                                             
                                                                                                  
 tf.__operators__.add_8 (TFOpLa  (None, 3, 132, 132,  0          ['tf.math.multiply_8[0][0]',     
 mbda)                           265)                             'max_pooling3d_8[0][0]']        
                                                                                                  
 tf.__operators__.add_9 (TFOpLa  (None, 3, 132, 132,  0          ['tf.math.multiply_9[0][0]',     
 mbda)                           265)                             'max_pooling3d_9[0][0]']        
                                                                                                  
 add_8 (Add)                    (None, 3, 132, 132,  0           ['max_pooling3d_8[0][0]',        
                                 265)                             'tf.__operators__.add_8[0][0]'] 
                                                                                                  
 add_9 (Add)                    (None, 3, 132, 132,  0           ['max_pooling3d_9[0][0]',        
                                 265)                             'tf.__operators__.add_9[0][0]'] 
                                                                                                  
 dense_48 (Dense)               (None, 3, 132, 132,  4256        ['add_8[0][0]']                  
                                 16)                                                              
                                                                                                  
 dense_51 (Dense)               (None, 3, 132, 132,  4256        ['add_9[0][0]']                  
                                 16)                                                              
                                                                                                  
 dense_49 (Dense)               (None, 3, 132, 132,  544         ['dense_48[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_52 (Dense)               (None, 3, 132, 132,  544         ['dense_51[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_50 (Dense)               (None, 3, 132, 132,  2112        ['dense_49[0][0]']               
                                 64)                                                              
                                                                                                  
 dense_53 (Dense)               (None, 3, 132, 132,  2112        ['dense_52[0][0]']               
                                 64)                                                              
                                                                                                  
 leaky_re_lu_19 (LeakyReLU)     (None, 3, 132, 132,  0           ['dense_50[0][0]']               
                                 64)                                                              
                                                                                                  
 leaky_re_lu_21 (LeakyReLU)     (None, 3, 132, 132,  0           ['dense_53[0][0]']               
                                 64)                                                              
                                                                                                  
 concatenate_4 (Concatenate)    (None, 3, 132, 132,  0           ['leaky_re_lu_19[0][0]',         
                                 128)                             'leaky_re_lu_21[0][0]']         
                                                                                                  
 dense_54 (Dense)               (None, 3, 132, 132,  2064        ['concatenate_4[0][0]']          
                                 16)                                                              
                                                                                                  
 dense_55 (Dense)               (None, 3, 132, 132,  544         ['dense_54[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_56 (Dense)               (None, 3, 132, 132,  2112        ['dense_55[0][0]']               
                                 64)                                                              
                                                                                                  
 flatten_4 (Flatten)            (None, 3345408)      0           ['dense_56[0][0]']               
                                                                                                  
 z_mean (Dense)                 (None, 4)            13381636    ['flatten_4[0][0]']              
                                                                                                  
 z_log_var (Dense)              (None, 4)            13381636    ['flatten_4[0][0]']              
                                                                                                  
 sampling_4 (Sampling)          (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 26,926,826
Trainable params: 26,926,826
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_13 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_14 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_33 (ConvLSTM2D)    (None, 6, 265, 265,  2624        ['input_13[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_37 (ConvLSTM2D)    (None, 6, 265, 265,  2624        ['input_14[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_34 (ConvLSTM2D)    (None, 6, 265, 265,  13888       ['conv_lstm2d_33[0][0]']         
                                 16)                                                              
                                                                                                  
 conv_lstm2d_38 (ConvLSTM2D)    (None, 6, 265, 265,  13888       ['conv_lstm2d_37[0][0]']         
                                 16)                                                              
                                                                                                  
 conv_lstm2d_35 (ConvLSTM2D)    (None, 6, 265, 265,  55424       ['conv_lstm2d_34[0][0]']         
                                 32)                                                              
                                                                                                  
 conv_lstm2d_39 (ConvLSTM2D)    (None, 6, 265, 265,  55424       ['conv_lstm2d_38[0][0]']         
                                 32)                                                              
                                                                                                  
 conv3d_8 (Conv3D)              (None, 6, 265, 265,  33          ['conv_lstm2d_35[0][0]']         
                                 1)                                                               
                                                                                                  
 conv3d_9 (Conv3D)              (None, 6, 265, 265,  33          ['conv_lstm2d_39[0][0]']         
                                 1)                                                               
                                                                                                  
 leaky_re_lu_18 (LeakyReLU)     (None, 6, 265, 265,  0           ['conv3d_8[0][0]']               
                                 1)                                                               
                                                                                                  
 leaky_re_lu_20 (LeakyReLU)     (None, 6, 265, 265,  0           ['conv3d_9[0][0]']               
                                 1)                                                               
                                                                                                  
 max_pooling3d_8 (MaxPooling3D)  (None, 3, 132, 132,  0          ['leaky_re_lu_18[0][0]']         
                                 1)                                                               
                                                                                                  
 max_pooling3d_9 (MaxPooling3D)  (None, 3, 132, 132,  0          ['leaky_re_lu_20[0][0]']         
                                 1)                                                               
                                                                                                  
 conv2d_33 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_32 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_37 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_36 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.linalg.matmul_16 (TFOpLambd  (None, 3, 132, 132,  0          ['conv2d_33[0][0]',              
 a)                              132)                             'conv2d_32[0][0]']              
                                                                                                  
 tf.linalg.matmul_18 (TFOpLambd  (None, 3, 132, 132,  0          ['conv2d_37[0][0]',              
 a)                              132)                             'conv2d_36[0][0]']              
                                                                                                  
 tf.nn.softmax_8 (TFOpLambda)   (None, 3, 132, 132,  0           ['tf.linalg.matmul_16[0][0]']    
                                 132)                                                             
                                                                                                  
 conv2d_34 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.nn.softmax_9 (TFOpLambda)   (None, 3, 132, 132,  0           ['tf.linalg.matmul_18[0][0]']    
                                 132)                                                             
                                                                                                  
 conv2d_38 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.linalg.matmul_17 (TFOpLambd  (None, 3, 132, 132,  0          ['tf.nn.softmax_8[0][0]',        
 a)                              1)                               'conv2d_34[0][0]']              
                                                                                                  
 tf.linalg.matmul_19 (TFOpLambd  (None, 3, 132, 132,  0          ['tf.nn.softmax_9[0][0]',        
 a)                              1)                               'conv2d_38[0][0]']              
                                                                                                  
 conv2d_35 (Conv2D)             (None, 3, 132, 132,  530         ['tf.linalg.matmul_17[0][0]']    
                                 265)                                                             
                                                                                                  
 conv2d_39 (Conv2D)             (None, 3, 132, 132,  530         ['tf.linalg.matmul_19[0][0]']    
                                 265)                                                             
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 3, 132, 132,  0          ['conv2d_35[0][0]']              
 )                               265)                                                             
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 3, 132, 132,  0          ['conv2d_39[0][0]']              
 )                               265)                                                             
                                                                                                  
 tf.__operators__.add_8 (TFOpLa  (None, 3, 132, 132,  0          ['tf.math.multiply_8[0][0]',     
 mbda)                           265)                             'max_pooling3d_8[0][0]']        
                                                                                                  
 tf.__operators__.add_9 (TFOpLa  (None, 3, 132, 132,  0          ['tf.math.multiply_9[0][0]',     
 mbda)                           265)                             'max_pooling3d_9[0][0]']        
                                                                                                  
 add_8 (Add)                    (None, 3, 132, 132,  0           ['max_pooling3d_8[0][0]',        
                                 265)                             'tf.__operators__.add_8[0][0]'] 
                                                                                                  
 add_9 (Add)                    (None, 3, 132, 132,  0           ['max_pooling3d_9[0][0]',        
                                 265)                             'tf.__operators__.add_9[0][0]'] 
                                                                                                  
 dense_48 (Dense)               (None, 3, 132, 132,  4256        ['add_8[0][0]']                  
                                 16)                                                              
                                                                                                  
 dense_51 (Dense)               (None, 3, 132, 132,  4256        ['add_9[0][0]']                  
                                 16)                                                              
                                                                                                  
 dense_49 (Dense)               (None, 3, 132, 132,  544         ['dense_48[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_52 (Dense)               (None, 3, 132, 132,  544         ['dense_51[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_50 (Dense)               (None, 3, 132, 132,  2112        ['dense_49[0][0]']               
                                 64)                                                              
                                                                                                  
 dense_53 (Dense)               (None, 3, 132, 132,  2112        ['dense_52[0][0]']               
                                 64)                                                              
                                                                                                  
 leaky_re_lu_19 (LeakyReLU)     (None, 3, 132, 132,  0           ['dense_50[0][0]']               
                                 64)                                                              
                                                                                                  
 leaky_re_lu_21 (LeakyReLU)     (None, 3, 132, 132,  0           ['dense_53[0][0]']               
                                 64)                                                              
                                                                                                  
 concatenate_4 (Concatenate)    (None, 3, 132, 132,  0           ['leaky_re_lu_19[0][0]',         
                                 128)                             'leaky_re_lu_21[0][0]']         
                                                                                                  
 dense_54 (Dense)               (None, 3, 132, 132,  2064        ['concatenate_4[0][0]']          
                                 16)                                                              
                                                                                                  
 dense_55 (Dense)               (None, 3, 132, 132,  544         ['dense_54[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_56 (Dense)               (None, 3, 132, 132,  2112        ['dense_55[0][0]']               
                                 64)                                                              
                                                                                                  
 flatten_4 (Flatten)            (None, 3345408)      0           ['dense_56[0][0]']               
                                                                                                  
 z_mean (Dense)                 (None, 4)            13381636    ['flatten_4[0][0]']              
                                                                                                  
 z_log_var (Dense)              (None, 4)            13381636    ['flatten_4[0][0]']              
                                                                                                  
 sampling_4 (Sampling)          (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 26,926,826
Trainable params: 26,926,826
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_13 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_14 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_33 (ConvLSTM2D)    (None, 6, 265, 265,  2624        ['input_13[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_37 (ConvLSTM2D)    (None, 6, 265, 265,  2624        ['input_14[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_34 (ConvLSTM2D)    (None, 6, 265, 265,  13888       ['conv_lstm2d_33[0][0]']         
                                 16)                                                              
                                                                                                  
 conv_lstm2d_38 (ConvLSTM2D)    (None, 6, 265, 265,  13888       ['conv_lstm2d_37[0][0]']         
                                 16)                                                              
                                                                                                  
 conv_lstm2d_35 (ConvLSTM2D)    (None, 6, 265, 265,  55424       ['conv_lstm2d_34[0][0]']         
                                 32)                                                              
                                                                                                  
 conv_lstm2d_39 (ConvLSTM2D)    (None, 6, 265, 265,  55424       ['conv_lstm2d_38[0][0]']         
                                 32)                                                              
                                                                                                  
 conv3d_8 (Conv3D)              (None, 6, 265, 265,  33          ['conv_lstm2d_35[0][0]']         
                                 1)                                                               
                                                                                                  
 conv3d_9 (Conv3D)              (None, 6, 265, 265,  33          ['conv_lstm2d_39[0][0]']         
                                 1)                                                               
                                                                                                  
 leaky_re_lu_18 (LeakyReLU)     (None, 6, 265, 265,  0           ['conv3d_8[0][0]']               
                                 1)                                                               
                                                                                                  
 leaky_re_lu_20 (LeakyReLU)     (None, 6, 265, 265,  0           ['conv3d_9[0][0]']               
                                 1)                                                               
                                                                                                  
 max_pooling3d_8 (MaxPooling3D)  (None, 3, 132, 132,  0          ['leaky_re_lu_18[0][0]']         
                                 1)                                                               
                                                                                                  
 max_pooling3d_9 (MaxPooling3D)  (None, 3, 132, 132,  0          ['leaky_re_lu_20[0][0]']         
                                 1)                                                               
                                                                                                  
 conv2d_33 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_32 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_37 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 conv2d_36 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.linalg.matmul_16 (TFOpLambd  (None, 3, 132, 132,  0          ['conv2d_33[0][0]',              
 a)                              132)                             'conv2d_32[0][0]']              
                                                                                                  
 tf.linalg.matmul_18 (TFOpLambd  (None, 3, 132, 132,  0          ['conv2d_37[0][0]',              
 a)                              132)                             'conv2d_36[0][0]']              
                                                                                                  
 tf.nn.softmax_8 (TFOpLambda)   (None, 3, 132, 132,  0           ['tf.linalg.matmul_16[0][0]']    
                                 132)                                                             
                                                                                                  
 conv2d_34 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_8[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.nn.softmax_9 (TFOpLambda)   (None, 3, 132, 132,  0           ['tf.linalg.matmul_18[0][0]']    
                                 132)                                                             
                                                                                                  
 conv2d_38 (Conv2D)             (None, 3, 132, 132,  2           ['max_pooling3d_9[0][0]']        
                                 1)                                                               
                                                                                                  
 tf.linalg.matmul_17 (TFOpLambd  (None, 3, 132, 132,  0          ['tf.nn.softmax_8[0][0]',        
 a)                              1)                               'conv2d_34[0][0]']              
                                                                                                  
 tf.linalg.matmul_19 (TFOpLambd  (None, 3, 132, 132,  0          ['tf.nn.softmax_9[0][0]',        
 a)                              1)                               'conv2d_38[0][0]']              
                                                                                                  
 conv2d_35 (Conv2D)             (None, 3, 132, 132,  530         ['tf.linalg.matmul_17[0][0]']    
                                 265)                                                             
                                                                                                  
 conv2d_39 (Conv2D)             (None, 3, 132, 132,  530         ['tf.linalg.matmul_19[0][0]']    
                                 265)                                                             
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 3, 132, 132,  0          ['conv2d_35[0][0]']              
 )                               265)                                                             
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 3, 132, 132,  0          ['conv2d_39[0][0]']              
 )                               265)                                                             
                                                                                                  
 tf.__operators__.add_8 (TFOpLa  (None, 3, 132, 132,  0          ['tf.math.multiply_8[0][0]',     
 mbda)                           265)                             'max_pooling3d_8[0][0]']        
                                                                                                  
 tf.__operators__.add_9 (TFOpLa  (None, 3, 132, 132,  0          ['tf.math.multiply_9[0][0]',     
 mbda)                           265)                             'max_pooling3d_9[0][0]']        
                                                                                                  
 add_8 (Add)                    (None, 3, 132, 132,  0           ['max_pooling3d_8[0][0]',        
                                 265)                             'tf.__operators__.add_8[0][0]'] 
                                                                                                  
 add_9 (Add)                    (None, 3, 132, 132,  0           ['max_pooling3d_9[0][0]',        
                                 265)                             'tf.__operators__.add_9[0][0]'] 
                                                                                                  
 dense_48 (Dense)               (None, 3, 132, 132,  4256        ['add_8[0][0]']                  
                                 16)                                                              
                                                                                                  
 dense_51 (Dense)               (None, 3, 132, 132,  4256        ['add_9[0][0]']                  
                                 16)                                                              
                                                                                                  
 dense_49 (Dense)               (None, 3, 132, 132,  544         ['dense_48[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_52 (Dense)               (None, 3, 132, 132,  544         ['dense_51[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_50 (Dense)               (None, 3, 132, 132,  2112        ['dense_49[0][0]']               
                                 64)                                                              
                                                                                                  
 dense_53 (Dense)               (None, 3, 132, 132,  2112        ['dense_52[0][0]']               
                                 64)                                                              
                                                                                                  
 leaky_re_lu_19 (LeakyReLU)     (None, 3, 132, 132,  0           ['dense_50[0][0]']               
                                 64)                                                              
                                                                                                  
 leaky_re_lu_21 (LeakyReLU)     (None, 3, 132, 132,  0           ['dense_53[0][0]']               
                                 64)                                                              
                                                                                                  
 concatenate_4 (Concatenate)    (None, 3, 132, 132,  0           ['leaky_re_lu_19[0][0]',         
                                 128)                             'leaky_re_lu_21[0][0]']         
                                                                                                  
 dense_54 (Dense)               (None, 3, 132, 132,  2064        ['concatenate_4[0][0]']          
                                 16)                                                              
                                                                                                  
 dense_55 (Dense)               (None, 3, 132, 132,  544         ['dense_54[0][0]']               
                                 32)                                                              
                                                                                                  
 dense_56 (Dense)               (None, 3, 132, 132,  2112        ['dense_55[0][0]']               
                                 64)                                                              
                                                                                                  
 flatten_4 (Flatten)            (None, 3345408)      0           ['dense_56[0][0]']               
                                                                                                  
 z_mean (Dense)                 (None, 4)            13381636    ['flatten_4[0][0]']              
                                                                                                  
 z_log_var (Dense)              (None, 4)            13381636    ['flatten_4[0][0]']              
                                                                                                  
 sampling_4 (Sampling)          (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 26,926,826
Trainable params: 26,926,826
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_16 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_17 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_41 (ConvLSTM2D)    (None, 6, 133, 133,  2624        ['input_16[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_45 (ConvLSTM2D)    (None, 6, 133, 133,  2624        ['input_17[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_42 (ConvLSTM2D)    (None, 6, 67, 67, 1  13888       ['conv_lstm2d_41[0][0]']         
                                6)                                                                
                                                                                                  
 conv_lstm2d_46 (ConvLSTM2D)    (None, 6, 67, 67, 1  13888       ['conv_lstm2d_45[0][0]']         
                                6)                                                                
                                                                                                  
 conv_lstm2d_43 (ConvLSTM2D)    (None, 6, 34, 34, 3  55424       ['conv_lstm2d_42[0][0]']         
                                2)                                                                
                                                                                                  
 conv_lstm2d_47 (ConvLSTM2D)    (None, 6, 34, 34, 3  55424       ['conv_lstm2d_46[0][0]']         
                                2)                                                                
                                                                                                  
 conv3d_10 (Conv3D)             (None, 6, 34, 34, 1  33          ['conv_lstm2d_43[0][0]']         
                                )                                                                 
                                                                                                  
 conv3d_11 (Conv3D)             (None, 6, 34, 34, 1  33          ['conv_lstm2d_47[0][0]']         
                                )                                                                 
                                                                                                  
 leaky_re_lu_22 (LeakyReLU)     (None, 6, 34, 34, 1  0           ['conv3d_10[0][0]']              
                                )                                                                 
                                                                                                  
 leaky_re_lu_24 (LeakyReLU)     (None, 6, 34, 34, 1  0           ['conv3d_11[0][0]']              
                                )                                                                 
                                                                                                  
 max_pooling3d_10 (MaxPooling3D  (None, 3, 17, 17, 1  0          ['leaky_re_lu_22[0][0]']         
 )                              )                                                                 
                                                                                                  
 max_pooling3d_11 (MaxPooling3D  (None, 3, 17, 17, 1  0          ['leaky_re_lu_24[0][0]']         
 )                              )                                                                 
                                                                                                  
 conv2d_41 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_10[0][0]']       
                                )                                                                 
                                                                                                  
 conv2d_40 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_10[0][0]']       
                                )                                                                 
                                                                                                  
 conv2d_45 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_11[0][0]']       
                                )                                                                 
                                                                                                  
 conv2d_44 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_11[0][0]']       
                                )                                                                 
                                                                                                  
 tf.linalg.matmul_20 (TFOpLambd  (None, 3, 17, 17, 1  0          ['conv2d_41[0][0]',              
 a)                             7)                                'conv2d_40[0][0]']              
                                                                                                  
 tf.linalg.matmul_22 (TFOpLambd  (None, 3, 17, 17, 1  0          ['conv2d_45[0][0]',              
 a)                             7)                                'conv2d_44[0][0]']              
                                                                                                  
 tf.nn.softmax_10 (TFOpLambda)  (None, 3, 17, 17, 1  0           ['tf.linalg.matmul_20[0][0]']    
                                7)                                                                
                                                                                                  
 conv2d_42 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_10[0][0]']       
                                )                                                                 
                                                                                                  
 tf.nn.softmax_11 (TFOpLambda)  (None, 3, 17, 17, 1  0           ['tf.linalg.matmul_22[0][0]']    
                                7)                                                                
                                                                                                  
 conv2d_46 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_11[0][0]']       
                                )                                                                 
                                                                                                  
 tf.linalg.matmul_21 (TFOpLambd  (None, 3, 17, 17, 1  0          ['tf.nn.softmax_10[0][0]',       
 a)                             )                                 'conv2d_42[0][0]']              
                                                                                                  
 tf.linalg.matmul_23 (TFOpLambd  (None, 3, 17, 17, 1  0          ['tf.nn.softmax_11[0][0]',       
 a)                             )                                 'conv2d_46[0][0]']              
                                                                                                  
 conv2d_43 (Conv2D)             (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_21[0][0]']    
                                65)                                                               
                                                                                                  
 conv2d_47 (Conv2D)             (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_23[0][0]']    
                                65)                                                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 3, 17, 17, 2  0          ['conv2d_43[0][0]']              
 a)                             65)                                                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 3, 17, 17, 2  0          ['conv2d_47[0][0]']              
 a)                             65)                                                               
                                                                                                  
 tf.__operators__.add_10 (TFOpL  (None, 3, 17, 17, 2  0          ['tf.math.multiply_10[0][0]',    
 ambda)                         65)                               'max_pooling3d_10[0][0]']       
                                                                                                  
 tf.__operators__.add_11 (TFOpL  (None, 3, 17, 17, 2  0          ['tf.math.multiply_11[0][0]',    
 ambda)                         65)                               'max_pooling3d_11[0][0]']       
                                                                                                  
 add_10 (Add)                   (None, 3, 17, 17, 2  0           ['max_pooling3d_10[0][0]',       
                                65)                               'tf.__operators__.add_10[0][0]']
                                                                                                  
 add_11 (Add)                   (None, 3, 17, 17, 2  0           ['max_pooling3d_11[0][0]',       
                                65)                               'tf.__operators__.add_11[0][0]']
                                                                                                  
 dense_59 (Dense)               (None, 3, 17, 17, 1  4256        ['add_10[0][0]']                 
                                6)                                                                
                                                                                                  
 dense_62 (Dense)               (None, 3, 17, 17, 1  4256        ['add_11[0][0]']                 
                                6)                                                                
                                                                                                  
 dense_60 (Dense)               (None, 3, 17, 17, 3  544         ['dense_59[0][0]']               
                                2)                                                                
                                                                                                  
 dense_63 (Dense)               (None, 3, 17, 17, 3  544         ['dense_62[0][0]']               
                                2)                                                                
                                                                                                  
 dense_61 (Dense)               (None, 3, 17, 17, 6  2112        ['dense_60[0][0]']               
                                4)                                                                
                                                                                                  
 dense_64 (Dense)               (None, 3, 17, 17, 6  2112        ['dense_63[0][0]']               
                                4)                                                                
                                                                                                  
 leaky_re_lu_23 (LeakyReLU)     (None, 3, 17, 17, 6  0           ['dense_61[0][0]']               
                                4)                                                                
                                                                                                  
 leaky_re_lu_25 (LeakyReLU)     (None, 3, 17, 17, 6  0           ['dense_64[0][0]']               
                                4)                                                                
                                                                                                  
 concatenate_5 (Concatenate)    (None, 3, 17, 17, 1  0           ['leaky_re_lu_23[0][0]',         
                                28)                               'leaky_re_lu_25[0][0]']         
                                                                                                  
 dense_65 (Dense)               (None, 3, 17, 17, 1  2064        ['concatenate_5[0][0]']          
                                6)                                                                
                                                                                                  
 dense_66 (Dense)               (None, 3, 17, 17, 3  544         ['dense_65[0][0]']               
                                2)                                                                
                                                                                                  
 dense_67 (Dense)               (None, 3, 17, 17, 6  2112        ['dense_66[0][0]']               
                                4)                                                                
                                                                                                  
 flatten_5 (Flatten)            (None, 55488)        0           ['dense_67[0][0]']               
                                                                                                  
 z_mean (Dense)                 (None, 4)            221956      ['flatten_5[0][0]']              
                                                                                                  
 z_log_var (Dense)              (None, 4)            221956      ['flatten_5[0][0]']              
                                                                                                  
 sampling_5 (Sampling)          (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 607,466
Trainable params: 607,466
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_18 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_19 (InputLayer)          [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_49 (ConvLSTM2D)    (None, 6, 133, 133,  2624        ['input_18[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_53 (ConvLSTM2D)    (None, 6, 133, 133,  2624        ['input_19[0][0]']               
                                 8)                                                               
                                                                                                  
 conv_lstm2d_50 (ConvLSTM2D)    (None, 6, 67, 67, 1  13888       ['conv_lstm2d_49[0][0]']         
                                6)                                                                
                                                                                                  
 conv_lstm2d_54 (ConvLSTM2D)    (None, 6, 67, 67, 1  13888       ['conv_lstm2d_53[0][0]']         
                                6)                                                                
                                                                                                  
 conv_lstm2d_51 (ConvLSTM2D)    (None, 6, 34, 34, 3  55424       ['conv_lstm2d_50[0][0]']         
                                2)                                                                
                                                                                                  
 conv_lstm2d_55 (ConvLSTM2D)    (None, 6, 34, 34, 3  55424       ['conv_lstm2d_54[0][0]']         
                                2)                                                                
                                                                                                  
 conv3d_12 (Conv3D)             (None, 6, 34, 34, 1  33          ['conv_lstm2d_51[0][0]']         
                                )                                                                 
                                                                                                  
 conv3d_13 (Conv3D)             (None, 6, 34, 34, 1  33          ['conv_lstm2d_55[0][0]']         
                                )                                                                 
                                                                                                  
 leaky_re_lu_26 (LeakyReLU)     (None, 6, 34, 34, 1  0           ['conv3d_12[0][0]']              
                                )                                                                 
                                                                                                  
 leaky_re_lu_28 (LeakyReLU)     (None, 6, 34, 34, 1  0           ['conv3d_13[0][0]']              
                                )                                                                 
                                                                                                  
 max_pooling3d_12 (MaxPooling3D  (None, 3, 17, 17, 1  0          ['leaky_re_lu_26[0][0]']         
 )                              )                                                                 
                                                                                                  
 max_pooling3d_13 (MaxPooling3D  (None, 3, 17, 17, 1  0          ['leaky_re_lu_28[0][0]']         
 )                              )                                                                 
                                                                                                  
 conv2d_49 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_12[0][0]']       
                                )                                                                 
                                                                                                  
 conv2d_48 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_12[0][0]']       
                                )                                                                 
                                                                                                  
 conv2d_53 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_13[0][0]']       
                                )                                                                 
                                                                                                  
 conv2d_52 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_13[0][0]']       
                                )                                                                 
                                                                                                  
 tf.linalg.matmul_24 (TFOpLambd  (None, 3, 17, 17, 1  0          ['conv2d_49[0][0]',              
 a)                             7)                                'conv2d_48[0][0]']              
                                                                                                  
 tf.linalg.matmul_26 (TFOpLambd  (None, 3, 17, 17, 1  0          ['conv2d_53[0][0]',              
 a)                             7)                                'conv2d_52[0][0]']              
                                                                                                  
 tf.nn.softmax_12 (TFOpLambda)  (None, 3, 17, 17, 1  0           ['tf.linalg.matmul_24[0][0]']    
                                7)                                                                
                                                                                                  
 conv2d_50 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_12[0][0]']       
                                )                                                                 
                                                                                                  
 tf.nn.softmax_13 (TFOpLambda)  (None, 3, 17, 17, 1  0           ['tf.linalg.matmul_26[0][0]']    
                                7)                                                                
                                                                                                  
 conv2d_54 (Conv2D)             (None, 3, 17, 17, 1  2           ['max_pooling3d_13[0][0]']       
                                )                                                                 
                                                                                                  
 tf.linalg.matmul_25 (TFOpLambd  (None, 3, 17, 17, 1  0          ['tf.nn.softmax_12[0][0]',       
 a)                             )                                 'conv2d_50[0][0]']              
                                                                                                  
 tf.linalg.matmul_27 (TFOpLambd  (None, 3, 17, 17, 1  0          ['tf.nn.softmax_13[0][0]',       
 a)                             )                                 'conv2d_54[0][0]']              
                                                                                                  
 conv2d_51 (Conv2D)             (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_25[0][0]']    
                                65)                                                               
                                                                                                  
 conv2d_55 (Conv2D)             (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_27[0][0]']    
                                65)                                                               
                                                                                                  
 tf.math.multiply_12 (TFOpLambd  (None, 3, 17, 17, 2  0          ['conv2d_51[0][0]']              
 a)                             65)                                                               
                                                                                                  
 tf.math.multiply_13 (TFOpLambd  (None, 3, 17, 17, 2  0          ['conv2d_55[0][0]']              
 a)                             65)                                                               
                                                                                                  
 tf.__operators__.add_12 (TFOpL  (None, 3, 17, 17, 2  0          ['tf.math.multiply_12[0][0]',    
 ambda)                         65)                               'max_pooling3d_12[0][0]']       
                                                                                                  
 tf.__operators__.add_13 (TFOpL  (None, 3, 17, 17, 2  0          ['tf.math.multiply_13[0][0]',    
 ambda)                         65)                               'max_pooling3d_13[0][0]']       
                                                                                                  
 add_12 (Add)                   (None, 3, 17, 17, 2  0           ['max_pooling3d_12[0][0]',       
                                65)                               'tf.__operators__.add_12[0][0]']
                                                                                                  
 add_13 (Add)                   (None, 3, 17, 17, 2  0           ['max_pooling3d_13[0][0]',       
                                65)                               'tf.__operators__.add_13[0][0]']
                                                                                                  
 dense_68 (Dense)               (None, 3, 17, 17, 1  4256        ['add_12[0][0]']                 
                                6)                                                                
                                                                                                  
 dense_71 (Dense)               (None, 3, 17, 17, 1  4256        ['add_13[0][0]']                 
                                6)                                                                
                                                                                                  
 dense_69 (Dense)               (None, 3, 17, 17, 3  544         ['dense_68[0][0]']               
                                2)                                                                
                                                                                                  
 dense_72 (Dense)               (None, 3, 17, 17, 3  544         ['dense_71[0][0]']               
                                2)                                                                
                                                                                                  
 dense_70 (Dense)               (None, 3, 17, 17, 6  2112        ['dense_69[0][0]']               
                                4)                                                                
                                                                                                  
 dense_73 (Dense)               (None, 3, 17, 17, 6  2112        ['dense_72[0][0]']               
                                4)                                                                
                                                                                                  
 leaky_re_lu_27 (LeakyReLU)     (None, 3, 17, 17, 6  0           ['dense_70[0][0]']               
                                4)                                                                
                                                                                                  
 leaky_re_lu_29 (LeakyReLU)     (None, 3, 17, 17, 6  0           ['dense_73[0][0]']               
                                4)                                                                
                                                                                                  
 concatenate_6 (Concatenate)    (None, 3, 17, 17, 1  0           ['leaky_re_lu_27[0][0]',         
                                28)                               'leaky_re_lu_29[0][0]']         
                                                                                                  
 dense_74 (Dense)               (None, 3, 17, 17, 1  2064        ['concatenate_6[0][0]']          
                                6)                                                                
                                                                                                  
 dense_75 (Dense)               (None, 3, 17, 17, 3  544         ['dense_74[0][0]']               
                                2)                                                                
                                                                                                  
 dense_76 (Dense)               (None, 3, 17, 17, 6  2112        ['dense_75[0][0]']               
                                4)                                                                
                                                                                                  
 flatten_6 (Flatten)            (None, 55488)        0           ['dense_76[0][0]']               
                                                                                                  
 z_mean (Dense)                 (None, 4)            221956      ['flatten_6[0][0]']              
                                                                                                  
 z_log_var (Dense)              (None, 4)            221956      ['flatten_6[0][0]']              
                                                                                                  
 sampling_6 (Sampling)          (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 607,466
Trainable params: 607,466
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_2 (InputLayer)           [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_1 (ConvLSTM2D)     (None, 6, 133, 133,  2624        ['input_1[0][0]']                
                                 8)                                                               
                                                                                                  
 conv_lstm2d_5 (ConvLSTM2D)     (None, 6, 133, 133,  2624        ['input_2[0][0]']                
                                 8)                                                               
                                                                                                  
 conv_lstm2d_2 (ConvLSTM2D)     (None, 6, 67, 67, 1  13888       ['conv_lstm2d_1[0][0]']          
                                6)                                                                
                                                                                                  
 conv_lstm2d_6 (ConvLSTM2D)     (None, 6, 67, 67, 1  13888       ['conv_lstm2d_5[0][0]']          
                                6)                                                                
                                                                                                  
 conv_lstm2d_3 (ConvLSTM2D)     (None, 6, 34, 34, 3  55424       ['conv_lstm2d_2[0][0]']          
                                2)                                                                
                                                                                                  
 conv_lstm2d_7 (ConvLSTM2D)     (None, 6, 34, 34, 3  55424       ['conv_lstm2d_6[0][0]']          
                                2)                                                                
                                                                                                  
 conv3d (Conv3D)                (None, 6, 34, 34, 1  33          ['conv_lstm2d_3[0][0]']          
                                )                                                                 
                                                                                                  
 conv3d_1 (Conv3D)              (None, 6, 34, 34, 1  33          ['conv_lstm2d_7[0][0]']          
                                )                                                                 
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 6, 34, 34, 1  0           ['conv3d[0][0]']                 
                                )                                                                 
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 6, 34, 34, 1  0           ['conv3d_1[0][0]']               
                                )                                                                 
                                                                                                  
 max_pooling3d (MaxPooling3D)   (None, 3, 17, 17, 1  0           ['leaky_re_lu[0][0]']            
                                )                                                                 
                                                                                                  
 max_pooling3d_1 (MaxPooling3D)  (None, 3, 17, 17, 1  0          ['leaky_re_lu_2[0][0]']          
                                )                                                                 
                                                                                                  
 conv2d_1 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d[0][0]']          
                                )                                                                 
                                                                                                  
 conv2d (Conv2D)                (None, 3, 17, 17, 1  2           ['max_pooling3d[0][0]']          
                                )                                                                 
                                                                                                  
 conv2d_5 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d_1[0][0]']        
                                )                                                                 
                                                                                                  
 conv2d_4 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d_1[0][0]']        
                                )                                                                 
                                                                                                  
 tf.linalg.matmul (TFOpLambda)  (None, 3, 17, 17, 1  0           ['conv2d_1[0][0]',               
                                7)                                'conv2d[0][0]']                 
                                                                                                  
 tf.linalg.matmul_2 (TFOpLambda  (None, 3, 17, 17, 1  0          ['conv2d_5[0][0]',               
 )                              7)                                'conv2d_4[0][0]']               
                                                                                                  
 tf.nn.softmax (TFOpLambda)     (None, 3, 17, 17, 1  0           ['tf.linalg.matmul[0][0]']       
                                7)                                                                
                                                                                                  
 conv2d_2 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d[0][0]']          
                                )                                                                 
                                                                                                  
 tf.nn.softmax_1 (TFOpLambda)   (None, 3, 17, 17, 1  0           ['tf.linalg.matmul_2[0][0]']     
                                7)                                                                
                                                                                                  
 conv2d_6 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d_1[0][0]']        
                                )                                                                 
                                                                                                  
 tf.linalg.matmul_1 (TFOpLambda  (None, 3, 17, 17, 1  0          ['tf.nn.softmax[0][0]',          
 )                              )                                 'conv2d_2[0][0]']               
                                                                                                  
 tf.linalg.matmul_3 (TFOpLambda  (None, 3, 17, 17, 1  0          ['tf.nn.softmax_1[0][0]',        
 )                              )                                 'conv2d_6[0][0]']               
                                                                                                  
 conv2d_3 (Conv2D)              (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_1[0][0]']     
                                65)                                                               
                                                                                                  
 conv2d_7 (Conv2D)              (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_3[0][0]']     
                                65)                                                               
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 3, 17, 17, 2  0           ['conv2d_3[0][0]']               
                                65)                                                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 3, 17, 17, 2  0          ['conv2d_7[0][0]']               
 )                              65)                                                               
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 3, 17, 17, 2  0          ['tf.math.multiply[0][0]',       
 da)                            65)                               'max_pooling3d[0][0]']          
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 3, 17, 17, 2  0          ['tf.math.multiply_1[0][0]',     
 mbda)                          65)                               'max_pooling3d_1[0][0]']        
                                                                                                  
 add (Add)                      (None, 3, 17, 17, 2  0           ['max_pooling3d[0][0]',          
                                65)                               'tf.__operators__.add[0][0]']   
                                                                                                  
 add_1 (Add)                    (None, 3, 17, 17, 2  0           ['max_pooling3d_1[0][0]',        
                                65)                               'tf.__operators__.add_1[0][0]'] 
                                                                                                  
 dense (Dense)                  (None, 3, 17, 17, 1  4256        ['add[0][0]']                    
                                6)                                                                
                                                                                                  
 dense_3 (Dense)                (None, 3, 17, 17, 1  4256        ['add_1[0][0]']                  
                                6)                                                                
                                                                                                  
 dense_1 (Dense)                (None, 3, 17, 17, 3  544         ['dense[0][0]']                  
                                2)                                                                
                                                                                                  
 dense_4 (Dense)                (None, 3, 17, 17, 3  544         ['dense_3[0][0]']                
                                2)                                                                
                                                                                                  
 dense_2 (Dense)                (None, 3, 17, 17, 6  2112        ['dense_1[0][0]']                
                                4)                                                                
                                                                                                  
 dense_5 (Dense)                (None, 3, 17, 17, 6  2112        ['dense_4[0][0]']                
                                4)                                                                
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 3, 17, 17, 6  0           ['dense_2[0][0]']                
                                4)                                                                
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 3, 17, 17, 6  0           ['dense_5[0][0]']                
                                4)                                                                
                                                                                                  
 concatenate (Concatenate)      (None, 3, 17, 17, 1  0           ['leaky_re_lu_1[0][0]',          
                                28)                               'leaky_re_lu_3[0][0]']          
                                                                                                  
 dense_6 (Dense)                (None, 3, 17, 17, 1  2064        ['concatenate[0][0]']            
                                6)                                                                
                                                                                                  
 dense_7 (Dense)                (None, 3, 17, 17, 3  544         ['dense_6[0][0]']                
                                2)                                                                
                                                                                                  
 dense_8 (Dense)                (None, 3, 17, 17, 6  2112        ['dense_7[0][0]']                
                                4)                                                                
                                                                                                  
 flatten (Flatten)              (None, 55488)        0           ['dense_8[0][0]']                
                                                                                                  
 z_mean (Dense)                 (None, 4)            221956      ['flatten[0][0]']                
                                                                                                  
 z_log_var (Dense)              (None, 4)            221956      ['flatten[0][0]']                
                                                                                                  
 sampling (Sampling)            (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 607,466
Trainable params: 607,466
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "encoder"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 input_2 (InputLayer)           [(None, 6, 265, 265  0           []                               
                                , 1)]                                                             
                                                                                                  
 conv_lstm2d_1 (ConvLSTM2D)     (None, 6, 133, 133,  2624        ['input_1[0][0]']                
                                 8)                                                               
                                                                                                  
 conv_lstm2d_5 (ConvLSTM2D)     (None, 6, 133, 133,  2624        ['input_2[0][0]']                
                                 8)                                                               
                                                                                                  
 conv_lstm2d_2 (ConvLSTM2D)     (None, 6, 67, 67, 1  13888       ['conv_lstm2d_1[0][0]']          
                                6)                                                                
                                                                                                  
 conv_lstm2d_6 (ConvLSTM2D)     (None, 6, 67, 67, 1  13888       ['conv_lstm2d_5[0][0]']          
                                6)                                                                
                                                                                                  
 conv_lstm2d_3 (ConvLSTM2D)     (None, 6, 34, 34, 3  55424       ['conv_lstm2d_2[0][0]']          
                                2)                                                                
                                                                                                  
 conv_lstm2d_7 (ConvLSTM2D)     (None, 6, 34, 34, 3  55424       ['conv_lstm2d_6[0][0]']          
                                2)                                                                
                                                                                                  
 conv3d (Conv3D)                (None, 6, 34, 34, 1  33          ['conv_lstm2d_3[0][0]']          
                                )                                                                 
                                                                                                  
 conv3d_1 (Conv3D)              (None, 6, 34, 34, 1  33          ['conv_lstm2d_7[0][0]']          
                                )                                                                 
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 6, 34, 34, 1  0           ['conv3d[0][0]']                 
                                )                                                                 
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 6, 34, 34, 1  0           ['conv3d_1[0][0]']               
                                )                                                                 
                                                                                                  
 max_pooling3d (MaxPooling3D)   (None, 3, 17, 17, 1  0           ['leaky_re_lu[0][0]']            
                                )                                                                 
                                                                                                  
 max_pooling3d_1 (MaxPooling3D)  (None, 3, 17, 17, 1  0          ['leaky_re_lu_2[0][0]']          
                                )                                                                 
                                                                                                  
 conv2d_1 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d[0][0]']          
                                )                                                                 
                                                                                                  
 conv2d (Conv2D)                (None, 3, 17, 17, 1  2           ['max_pooling3d[0][0]']          
                                )                                                                 
                                                                                                  
 conv2d_5 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d_1[0][0]']        
                                )                                                                 
                                                                                                  
 conv2d_4 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d_1[0][0]']        
                                )                                                                 
                                                                                                  
 tf.linalg.matmul (TFOpLambda)  (None, 3, 17, 17, 1  0           ['conv2d_1[0][0]',               
                                7)                                'conv2d[0][0]']                 
                                                                                                  
 tf.linalg.matmul_2 (TFOpLambda  (None, 3, 17, 17, 1  0          ['conv2d_5[0][0]',               
 )                              7)                                'conv2d_4[0][0]']               
                                                                                                  
 tf.nn.softmax (TFOpLambda)     (None, 3, 17, 17, 1  0           ['tf.linalg.matmul[0][0]']       
                                7)                                                                
                                                                                                  
 conv2d_2 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d[0][0]']          
                                )                                                                 
                                                                                                  
 tf.nn.softmax_1 (TFOpLambda)   (None, 3, 17, 17, 1  0           ['tf.linalg.matmul_2[0][0]']     
                                7)                                                                
                                                                                                  
 conv2d_6 (Conv2D)              (None, 3, 17, 17, 1  2           ['max_pooling3d_1[0][0]']        
                                )                                                                 
                                                                                                  
 tf.linalg.matmul_1 (TFOpLambda  (None, 3, 17, 17, 1  0          ['tf.nn.softmax[0][0]',          
 )                              )                                 'conv2d_2[0][0]']               
                                                                                                  
 tf.linalg.matmul_3 (TFOpLambda  (None, 3, 17, 17, 1  0          ['tf.nn.softmax_1[0][0]',        
 )                              )                                 'conv2d_6[0][0]']               
                                                                                                  
 conv2d_3 (Conv2D)              (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_1[0][0]']     
                                65)                                                               
                                                                                                  
 conv2d_7 (Conv2D)              (None, 3, 17, 17, 2  530         ['tf.linalg.matmul_3[0][0]']     
                                65)                                                               
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 3, 17, 17, 2  0           ['conv2d_3[0][0]']               
                                65)                                                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 3, 17, 17, 2  0          ['conv2d_7[0][0]']               
 )                              65)                                                               
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 3, 17, 17, 2  0          ['tf.math.multiply[0][0]',       
 da)                            65)                               'max_pooling3d[0][0]']          
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 3, 17, 17, 2  0          ['tf.math.multiply_1[0][0]',     
 mbda)                          65)                               'max_pooling3d_1[0][0]']        
                                                                                                  
 add (Add)                      (None, 3, 17, 17, 2  0           ['max_pooling3d[0][0]',          
                                65)                               'tf.__operators__.add[0][0]']   
                                                                                                  
 add_1 (Add)                    (None, 3, 17, 17, 2  0           ['max_pooling3d_1[0][0]',        
                                65)                               'tf.__operators__.add_1[0][0]'] 
                                                                                                  
 dense (Dense)                  (None, 3, 17, 17, 1  4256        ['add[0][0]']                    
                                6)                                                                
                                                                                                  
 dense_3 (Dense)                (None, 3, 17, 17, 1  4256        ['add_1[0][0]']                  
                                6)                                                                
                                                                                                  
 dense_1 (Dense)                (None, 3, 17, 17, 3  544         ['dense[0][0]']                  
                                2)                                                                
                                                                                                  
 dense_4 (Dense)                (None, 3, 17, 17, 3  544         ['dense_3[0][0]']                
                                2)                                                                
                                                                                                  
 dense_2 (Dense)                (None, 3, 17, 17, 6  2112        ['dense_1[0][0]']                
                                4)                                                                
                                                                                                  
 dense_5 (Dense)                (None, 3, 17, 17, 6  2112        ['dense_4[0][0]']                
                                4)                                                                
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 3, 17, 17, 6  0           ['dense_2[0][0]']                
                                4)                                                                
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 3, 17, 17, 6  0           ['dense_5[0][0]']                
                                4)                                                                
                                                                                                  
 concatenate (Concatenate)      (None, 3, 17, 17, 1  0           ['leaky_re_lu_1[0][0]',          
                                28)                               'leaky_re_lu_3[0][0]']          
                                                                                                  
 dense_6 (Dense)                (None, 3, 17, 17, 1  2064        ['concatenate[0][0]']            
                                6)                                                                
                                                                                                  
 dense_7 (Dense)                (None, 3, 17, 17, 3  544         ['dense_6[0][0]']                
                                2)                                                                
                                                                                                  
 dense_8 (Dense)                (None, 3, 17, 17, 6  2112        ['dense_7[0][0]']                
                                4)                                                                
                                                                                                  
 flatten (Flatten)              (None, 55488)        0           ['dense_8[0][0]']                
                                                                                                  
 z_mean (Dense)                 (None, 4)            221956      ['flatten[0][0]']                
                                                                                                  
 z_log_var (Dense)              (None, 4)            221956      ['flatten[0][0]']                
                                                                                                  
 sampling (Sampling)            (None, 4)            0           ['z_mean[0][0]',                 
                                                                  'z_log_var[0][0]']              
                                                                                                  
==================================================================================================
Total params: 607,466
Trainable params: 607,466
Non-trainable params: 0
__________________________________________________________________________________________________
